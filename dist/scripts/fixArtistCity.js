"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const bootstrap_1 = require("./bootstrap");
const Contestant_1 = require("../models/Contestant");
let mongoose;
bootstrap_1.default().then((obj) => {
    mongoose = obj.mongoose;
    return start();
}).then(() => {
    console.log('done');
    return mongoose.connection.close();
}).catch(e => {
    console.error(e);
    if (mongoose.connection) {
        return mongoose.connection.close();
    }
}).then(() => {
    console.log('closed db conn');
});
async function start() {
    return processArtists();
}
async function processArtists() {
    const contestants = await Contestant_1.default.find({ $or: [{ CityText: /.*undefined*/ }, { CityText: /.*null*/ }] });
    for (let i = 0; i < contestants.length; i++) {
        const contestant = contestants[i];
        if (contestant.CityText.includes('null')) {
            contestant.CityText = contestant.CityText.replace(/, null/g, '');
            await contestant.save();
        }
        else if (contestant.CityText.includes('undefined')) {
            contestant.CityText = contestant.CityText.replace(/, undefined/g, '');
            await contestant.save();
        }
    }
}

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdHMvZml4QXJ0aXN0Q2l0eS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLDJDQUFrQztBQUNsQyxxREFBbUQ7QUFFbkQsSUFBSSxRQUFtQyxDQUFDO0FBQ3hDLG1CQUFPLEVBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLEVBQUUsRUFBRTtJQUNuQixRQUFRLEdBQUcsR0FBRyxDQUFDLFFBQVEsQ0FBQztJQUN4QixPQUFPLEtBQUssRUFBRSxDQUFDO0FBQ25CLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUU7SUFDVCxPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ3BCLE9BQU8sUUFBUSxDQUFDLFVBQVUsQ0FBQyxLQUFLLEVBQUUsQ0FBQztBQUN2QyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUU7SUFDVCxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ2pCLElBQUksUUFBUSxDQUFDLFVBQVUsRUFBRTtRQUNyQixPQUFPLFFBQVEsQ0FBQyxVQUFVLENBQUMsS0FBSyxFQUFFLENBQUM7S0FDdEM7QUFDTCxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFO0lBQ1QsT0FBTyxDQUFDLEdBQUcsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO0FBQ2xDLENBQUMsQ0FBQyxDQUFDO0FBSUgsS0FBSyxVQUFVLEtBQUs7SUFDaEIsT0FBTyxjQUFjLEVBQUUsQ0FBQztBQUM1QixDQUFDO0FBRUQsS0FBSyxVQUFVLGNBQWM7SUFDMUIsTUFBTSxXQUFXLEdBQUcsTUFBTSxvQkFBZSxDQUFDLElBQUksQ0FBQyxFQUFDLEdBQUcsRUFBRSxDQUFDLEVBQUMsUUFBUSxFQUFFLGNBQWMsRUFBQyxFQUFFLEVBQUMsUUFBUSxFQUFFLFNBQVMsRUFBQyxDQUFDLEVBQUMsQ0FBQyxDQUFDO0lBQzNHLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxXQUFXLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFO1FBQ3pDLE1BQU0sVUFBVSxHQUFHLFdBQVcsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNsQyxJQUFJLFVBQVUsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxFQUFFO1lBQ3RDLFVBQVUsQ0FBQyxRQUFRLEdBQUcsVUFBVSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsU0FBUyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1lBQ2pFLE1BQU0sVUFBVSxDQUFDLElBQUksRUFBRSxDQUFDO1NBQzNCO2FBQU0sSUFBSSxVQUFVLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxXQUFXLENBQUMsRUFBRTtZQUNsRCxVQUFVLENBQUMsUUFBUSxHQUFHLFVBQVUsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLGNBQWMsRUFBRSxFQUFFLENBQUMsQ0FBQztZQUN0RSxNQUFNLFVBQVUsQ0FBQyxJQUFJLEVBQUUsQ0FBQztTQUMzQjtLQUNKO0FBQ0osQ0FBQyIsImZpbGUiOiJzY3JpcHRzL2ZpeEFydGlzdENpdHkuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbG9hZEFwcCBmcm9tICcuL2Jvb3RzdHJhcCc7XG5pbXBvcnQgQ29udGVzdGFudE1vZGVsIGZyb20gJy4uL21vZGVscy9Db250ZXN0YW50JztcblxubGV0IG1vbmdvb3NlOiB0eXBlb2YgaW1wb3J0KCdtb25nb29zZScpO1xubG9hZEFwcCgpLnRoZW4oKG9iaikgPT4ge1xuICAgIG1vbmdvb3NlID0gb2JqLm1vbmdvb3NlO1xuICAgIHJldHVybiBzdGFydCgpO1xufSkudGhlbigoKSA9PiB7XG4gICAgY29uc29sZS5sb2coJ2RvbmUnKTtcbiAgICByZXR1cm4gbW9uZ29vc2UuY29ubmVjdGlvbi5jbG9zZSgpO1xufSkuY2F0Y2goZSA9PiB7XG4gICAgY29uc29sZS5lcnJvcihlKTtcbiAgICBpZiAobW9uZ29vc2UuY29ubmVjdGlvbikge1xuICAgICAgICByZXR1cm4gbW9uZ29vc2UuY29ubmVjdGlvbi5jbG9zZSgpO1xuICAgIH1cbn0pLnRoZW4oKCkgPT4ge1xuICAgIGNvbnNvbGUubG9nKCdjbG9zZWQgZGIgY29ubicpO1xufSk7XG4vLyBAdHMtaWdub3JlXG5pbXBvcnQgZ290ID0gcmVxdWlyZSgnZ290Jyk7XG5cbmFzeW5jIGZ1bmN0aW9uIHN0YXJ0KCkge1xuICAgIHJldHVybiBwcm9jZXNzQXJ0aXN0cygpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBwcm9jZXNzQXJ0aXN0cygpOiBQcm9taXNlPGFueT4ge1xuICAgY29uc3QgY29udGVzdGFudHMgPSBhd2FpdCBDb250ZXN0YW50TW9kZWwuZmluZCh7JG9yOiBbe0NpdHlUZXh0OiAvLip1bmRlZmluZWQqL30sIHtDaXR5VGV4dDogLy4qbnVsbCovfV19KTtcbiAgIGZvciAobGV0IGkgPSAwOyBpIDwgY29udGVzdGFudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICBjb25zdCBjb250ZXN0YW50ID0gY29udGVzdGFudHNbaV07XG4gICAgICAgaWYgKGNvbnRlc3RhbnQuQ2l0eVRleHQuaW5jbHVkZXMoJ251bGwnKSkge1xuICAgICAgICAgICBjb250ZXN0YW50LkNpdHlUZXh0ID0gY29udGVzdGFudC5DaXR5VGV4dC5yZXBsYWNlKC8sIG51bGwvZywgJycpO1xuICAgICAgICAgICBhd2FpdCBjb250ZXN0YW50LnNhdmUoKTtcbiAgICAgICB9IGVsc2UgaWYgKGNvbnRlc3RhbnQuQ2l0eVRleHQuaW5jbHVkZXMoJ3VuZGVmaW5lZCcpKSB7XG4gICAgICAgICAgIGNvbnRlc3RhbnQuQ2l0eVRleHQgPSBjb250ZXN0YW50LkNpdHlUZXh0LnJlcGxhY2UoLywgdW5kZWZpbmVkL2csICcnKTtcbiAgICAgICAgICAgYXdhaXQgY29udGVzdGFudC5zYXZlKCk7XG4gICAgICAgfVxuICAgfVxufSJdfQ==
